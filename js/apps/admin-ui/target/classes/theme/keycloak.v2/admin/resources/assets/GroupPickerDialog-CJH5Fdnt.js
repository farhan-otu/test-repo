import{jsx as s,jsxs as x}from"react/jsx-runtime";import{ar as J,as as A,dX as W,bl as Y,u as Z,a as U,j as ee,M as ae,m as O,f as S,av as te,dx as se,dy as F,h as T,at as ie}from"./main-hjbDDO6j.js";import*as v from"react";import{useState as p}from"react";import{s as L,d as ne,D as le,a as ce,b as re,c as oe}from"./DataListItemRow-C-0mzg8R.js";const X=e=>{var{children:i,className:r,visibility:c,id:b,"aria-label":f,"aria-labelledby":u,isPlainButtonAction:o}=e,d=J(e,["children","className","visibility","id","aria-label","aria-labelledby","isPlainButtonAction"]);return v.createElement("div",Object.assign({className:A(L.dataListItemAction,W(c,L),r)},d),o?v.createElement("div",{className:A(L.dataListAction)},i):i)};X.displayName="DataListAction";const _=e=>{var{className:i="",onChange:r=(k,l)=>{},isValid:c=!0,isDisabled:b=!1,isChecked:f=!1,checked:u=!1,defaultChecked:o,otherControls:d=!1}=e,n=J(e,["className","onChange","isValid","isDisabled","isChecked","checked","defaultChecked","otherControls"]);const m=v.createElement("div",{className:A(L.dataListCheck)},v.createElement("input",Object.assign({},n,{type:"checkbox",onChange:k=>r(k,k.currentTarget.checked),"aria-invalid":!c,disabled:b},[!0,!1].includes(o)&&{defaultChecked:o},![!0,!1].includes(o)&&{checked:f||u})));return v.createElement(v.Fragment,null,!d&&v.createElement("div",{className:A(L.dataListItemControl,i)},m),d&&m)};_.displayName="DataListCheck";const de=({group:{path:e},onMouseEnter:i,...r})=>{const[c,b]=p(""),u=s("span",{onMouseEnter:o=>{b(e),i?.(o)},...r,children:e});return c!==""?s(Y,{content:c,isVisible:!0,children:u}):u},be=({id:e,type:i,filterGroups:r,text:c,canBrowse:b=!0,isMove:f=!1,onClose:u,onConfirm:o})=>{const{adminClient:d}=Z(),{t:n}=U(),[m,k]=p([]),[l,G]=p([]),[D,z]=p([]),[h,P]=p(""),[H,K]=p([]),[y,E]=p(),[N,I]=p(10),[w,C]=p(0),[Q,j]=p(0),R=()=>l[l.length-1];ee(async()=>{let a,t,M;if(y){if(!l.map(({id:B})=>B).includes(y)&&(a=await d.groups.findOne({id:y}),!a))throw new Error(n("notFound"));const g={first:w,max:N,parentId:y};t=await d.groups.listSubGroups(g)}else{const g={first:w,max:N+1};h!==""&&(g.search=h),t=await d.groups.find(g)}return e&&(M=await d.users.listGroups({id:e})),{group:a,groups:t,existingUserGroups:M}},async({group:a,groups:t,existingUserGroups:M})=>{K(M||[]),a&&(G([...l,a]),j(a.subGroupCount)),t.forEach(g=>{g.checked=!!m.find(B=>B.id===g.id)}),z(t),(h!==""||!y)&&j(t.length)},[y,h,w,N]);const $=a=>[...H.map(t=>t.id),...(r||[]).map(t=>t.id)].some(t=>t===a?.id);return s(ae,{variant:h!==""?O.medium:O.small,title:n(c.title,{group1:r?.[0]?.name,group2:l.length?R().name:n("root")}),isOpen:!0,onClose:u,actions:[s(S,{"data-testid":`${c.ok}-button`,variant:"primary",form:"group-form",onClick:()=>{o(i==="selectMany"?m:l.length?[R()]:void 0)},isDisabled:i==="selectMany"&&m.length===0,children:n(c.ok)},"confirm")],children:x(te,{count:Q,first:w,max:N,onNextClick:C,onPreviousClick:C,onPerPageSelect:(a,t)=>{C(a),I(t)},inputGroupName:"search",inputGroupOnEnter:a=>{P(a),C(0),I(10),G([]),E(void 0)},inputGroupPlaceholder:n("searchForGroups"),children:[x(se,{children:[l.length>0&&s(F,{children:s(S,{variant:"link",onClick:()=>{E(void 0),G([]),C(0),I(10)},children:n("groups")})},"home"),l.map((a,t)=>x(F,{children:[l.length-1!==t&&s(S,{variant:"link",onClick:()=>{E(a.id),G([...l].slice(0,t)),C(0),I(10)},children:a.name}),l.length-1===t&&a.name]},t))]}),s(ne,{"aria-label":n("groups"),isCompact:!0,children:h==""?D.slice(0,N).map(a=>s(V,{group:a,isRowDisabled:$,onSelect:t=>{E(t.id),C(0)},type:i,isSearching:h!=="",setIsSearching:t=>P(t?"":h),selectedRows:m,setSelectedRows:k,canBrowse:b},a.id)):D?.map(a=>q(a)).map(a=>s(V,{group:a,isRowDisabled:$,type:i,isSearching:!0,selectedRows:m,setSelectedRows:k,canBrowse:!1},a.id))}),D.length===0&&h===""&&s(T,{hasIcon:!1,message:n("moveGroupEmpty"),instructions:f?n("moveGroupEmptyInstructions"):void 0}),D.length===0&&h!==""&&s(T,{message:n("noSearchResults"),instructions:n("noSearchResultsInstructions")})]})})},q=e=>{let i=e;return e.subGroups?.length===1&&(i=q(e.subGroups[0])),i},V=({group:e,type:i,isRowDisabled:r,isSearching:c,setIsSearching:b,onSelect:f,selectedRows:u,setSelectedRows:o,canBrowse:d})=>{const{t:n}=U();return s(le,{"aria-labelledby":e.name,id:e.id,onClick:m=>{i==="selectOne"?f?.(e):m.target.type!=="checkbox"&&e.subGroupCount!==0&&(f?.(e),b?.(!1))},children:x(ce,{className:`join-group-dialog-row${r(e)?"-m-disabled":""}`,"data-testid":e.name,children:[i==="selectMany"&&s(_,{className:"kc-join-group-modal-check","data-testid":`${e.name}-check`,"aria-label":e.name,checked:e.checked,isDisabled:r(e),onChange:(m,k)=>{e.checked=k;let l=[];e.checked?l=[...u,e]:l=u.filter(G=>G.id!==e.id),o(l)},"aria-labelledby":`select-${e.name}`}),s(re,{dataListCells:[s(oe,{className:"keycloak-groups-group-path",children:c?s(de,{id:`select-${e.name}`,group:e}):s("span",{id:`select-${e.name}`,children:e.name})},`name-${e.id}`)]}),s(X,{id:"actions","aria-labelledby":`select-${e.name}`,"aria-label":n("groupName"),isPlainButtonAction:!0,children:(d||i==="selectOne")&&e.subGroupCount!==0&&s(S,{variant:"link","aria-label":n("select"),children:s(ie,{})})})]})},e.id)};export{be as G,de as a};
//# sourceMappingURL=GroupPickerDialog-CJH5Fdnt.js.map
