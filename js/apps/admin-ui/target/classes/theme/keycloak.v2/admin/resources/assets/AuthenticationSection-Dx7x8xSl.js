import{jsx as e,jsxs as b,Fragment as R}from"react/jsx-runtime";import{u as E,a as C,V as D,l as L,j as ie,M as we,m as ve,F as Ve,n as U,A as K,f as w,B as O,o as ne,p as le,q as x,d as _,y as oe,S as J,r as re,s as Ie,v as Ce,x as Se,z as Z,C as Te,E as Me,G as Re,H as ee,I as $e,w as Ee,P as M,$ as j,J as W,K as Le,N as q,_ as V,O as te,R as ce,Q as de,U as Ue,W as Ke,X as _e,Y as Be,Z as Ge,a0 as ue,a1 as je,a2 as me,a3 as We,a4 as Ye,a5 as ze,e as ke,a6 as Xe,a7 as Qe,T as Ne,a8 as Je,a9 as Ze,aa as et,ab as tt,ac as at,ad as it,ae as nt,af as lt,ag as ot,ah as st,ai as rt,aj as ct,ak as dt,al as ut,am as pe,L as xe,an as mt,h as pt,ao as ht,ap as bt}from"./main-hjbDDO6j.js";import{useState as T,useEffect as Y,useMemo as Oe}from"react";import{u as yt}from"./ConfirmDialog-DN_NVsrg.js";import{R as ft,u as At}from"./RoutableTabs-ChOqIl6o.js";import{V as gt}from"./ViewHeader-Dr6ZoEJz.js";import{u as De,m as Pt}from"./useLocaleSort-Bon3wgU4.js";import{C as wt,R as vt,D as It,B as Ct}from"./DuplicateFlowModal-NUwp0r8k.js";import{D as St}from"./DraggableTable-B1QRalkE.js";import{D as Tt}from"./DynamicComponents-2Oogxguf.js";import{T as Rt}from"./trash-icon-fO6THQ8J.js";import{f as Et}from"./AddRoleMappingModal-B-7S42YC.js";import{F as z}from"./FormAccess-DEsYjDHG.js";import{T as He}from"./TimeSelectorControl-BNkqjzSp.js";import{M as he}from"./MultiLineInput-BKovUfcB.js";import{Q as _t}from"./question-circle-icon-BckMEuvu.js";import{T as kt,a as k,b as N}from"./Tabs-TiG_cKa2.js";import{T as Nt}from"./Trans-BCvPJnzT.js";import{s as xt}from"./sortBy-D1UyZ0jY.js";import"react-dom";import"./PageHandler-Dm6Ir_Zl.js";import"./useParams-XtwJXIDJ.js";import"./constants-BclHbWtx.js";import"./NameDescription-DOvD66hY.js";import"./DataListItemRow-C-0mzg8R.js";import"./ClientSelect-Di5Ep3wz.js";import"./FileUpload-DFzHUp8z.js";import"./CodeEditor-BF8OqNGf.js";import"./copy-icon-ePLWnxgr.js";import"./GroupPickerDialog-CJH5Fdnt.js";import"./KeySelect-CBdQO7FV.js";import"./translationFormatter-aKDacg4X.js";import"./filter-icon-I49U7vdU.js";import"./TimeSelector-C-6T-B4N.js";import"./_baseFlatten-DK0O-V_R.js";const Ot=({requiredAction:i,onClose:n})=>{const{adminClient:l}=E(),{t}=C(),{addAlert:a,addError:r}=D(),[m,c]=T(),p=L(),{setValue:g,handleSubmit:h}=p,f=d=>{ne(d||{},g)};ie(async()=>{const d=await l.authenticationManagement.getRequiredActionConfigDescription({alias:i.alias}),y=await l.authenticationManagement.getRequiredActionConfig({alias:i.alias});return d.properties=[...d.properties],{configDescription:d,config:y}},({configDescription:d,config:y})=>{c(d),f(y)},[]);const I=async d=>{const y=le(d);try{await l.authenticationManagement.updateRequiredActionConfig({alias:i.alias},y),f(y),a(t("configSaveSuccess"),x.success),n()}catch(v){r("configSaveError",v)}};return e(we,{variant:ve.small,isOpen:!0,title:t("requiredActionConfig",{name:i.name}),onClose:n,children:b(Ve,{id:"required-action-config-form",onSubmit:h(I),children:[e(U,{...p,children:e(Tt,{stringify:!0,properties:m?.properties||[]})}),b(K,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",children:t("save")}),e(w,{"data-testid":"cancel",variant:O.link,onClick:n,children:t("cancel")}),b(w,{className:"pf-v5-u-ml-3xl","data-testid":"clear",variant:O.link,onClick:async()=>{await l.authenticationManagement.removeRequiredActionConfig({alias:i.alias}),p.reset({}),n()},children:[t("clear")," ",e(Rt,{})]})]})]})})},Dt=()=>{const{adminClient:i}=E(),{t:n}=C(),{addAlert:l,addError:t}=D(),[a,r]=T(),[m,c]=T(),[p,g]=T(0),h=()=>g(p+1),{realm:f}=_(),I=async()=>await(await Ie(`${Se(i.baseUrl)}admin/realms/${f}/ui-ext/authentication-management/required-actions`,{method:"GET",headers:Ce(await i.getAccessToken())})).json();ie(async()=>{const[s,A]=await Promise.all([I(),i.authenticationManagement.getUnregisteredRequiredActions()]);return[...s.map(o=>({name:o.name,enabled:o.enabled,defaultAction:o.defaultAction,data:o})),...A.map(o=>({name:o.name,enabled:!1,defaultAction:!1,data:o}))]},s=>r(s),[p]);const d=s=>!("alias"in s),y=async(s,A)=>{try{A in s?(s[A]=!s[A],delete s.configurable,await i.authenticationManagement.updateRequiredAction({alias:s.alias},s)):d(s)&&await i.authenticationManagement.registerRequiredAction({name:s.name,providerId:s.providerId}),h(),l(n("updatedRequiredActionSuccess"),x.success)}catch(o){t("updatedRequiredActionError",o)}},v=async(s,A)=>{try{const o=s.alias;for(let u=0;u<Math.abs(A);u++)A>0?await i.authenticationManagement.lowerRequiredActionPriority({alias:o}):await i.authenticationManagement.raiseRequiredActionPriority({alias:o});h(),l(n("updatedRequiredActionSuccess"),x.success)}catch(o){t("updatedRequiredActionError",o)}};return a?b(R,{children:[m&&e(Ot,{requiredAction:m,onClose:()=>c(void 0)}),e(St,{keyField:"name",onDragFinish:async(s,A)=>{const o=a.map(P=>P.name),u=A.indexOf(s),S=o.indexOf(s),H=a[S].data;if(!H.alias)return;const X=u-S;v(H,X)},columns:[{name:"name",displayKey:"action",width:50},{name:"enabled",displayKey:"enabled",cellRenderer:s=>e(J,{id:`enable-${re(s.name||"")}`,label:n("on"),labelOff:n("off"),isChecked:s.enabled,onChange:()=>{y(s.data,"enabled")},"aria-label":s.name}),width:20},{name:"default",displayKey:"setAsDefaultAction",thTooltipText:"authDefaultActionTooltip",cellRenderer:s=>e(J,{id:`default-${re(s.name||"")}`,label:n("on"),isDisabled:!s.enabled,labelOff:s.enabled?n("off"):n("disabledOff"),isChecked:s.defaultAction,onChange:()=>{y(s.data,"defaultAction")},"aria-label":s.name}),width:20},{name:"config",displayKey:"configure",cellRenderer:s=>s.data.configurable?e(w,{variant:"plain","aria-label":n("settings"),onClick:()=>c(s.data),children:e(wt,{})}):void 0,width:10}],data:a})]}):e(oe,{})},Ht="_label_1u2bs_1",ae={label:Ht},Q=({label:i})=>b(R,{children:[e(Me,{className:ae.label})," ",i]}),Ft=({id:i,isSpecificClient:n,onClose:l})=>{const{adminClient:t}=E(),{t:a}=C(),r=async(m,c,p)=>(await Et(t,{id:i,type:n?"clients":"idp",first:m||0,max:c||10,search:p})).map(h=>({name:h}));return e(we,{header:b(Re,{children:[e(ee,{component:$e.h1,children:a("flowUsedBy")}),e(ee,{children:a("flowUsedByDescription",{value:a(n?"clients":"identiyProviders")})})]}),variant:ve.medium,isOpen:!0,onClose:l,actions:[e(w,{"data-testid":"cancel",id:"modal-cancel",onClick:l,children:a("close")},"cancel")],children:e(Ee,{loader:r,isPaginated:!0,ariaLabelKey:"usedBy",searchPlaceholderKey:"search",columns:[{name:"name"}]})})},qt=({authType:{id:i,usedBy:n}})=>{const{t:l}=C(),{realmRepresentation:t}=_(),[a,r]=Z(),m=Object.entries(t).find(c=>c[1]===n?.values[0])?.[0];return b(R,{children:[a&&e(Ft,{id:i,onClose:r,isSpecificClient:n?.type==="SPECIFIC_CLIENTS"}),(n?.type==="SPECIFIC_PROVIDERS"||n?.type==="SPECIFIC_CLIENTS")&&(n.values.length<=8?e(Te,{"aria-label":l("usedBy"),bodyContent:b("div",{children:[l("appliedBy"+(n.type==="SPECIFIC_CLIENTS"?"Clients":"Providers"))," ",n.values.map((c,p)=>b(R,{children:[e("strong",{children:c}),p<n.values.length-1?", ":""]}))]},`usedBy-${i}-${n.values}`),children:e(w,{variant:"link",className:ae.label,children:e(Q,{label:l(`used.${n.type}`)})})},i):e(w,{variant:"link",className:ae.label,onClick:r,children:e(Q,{label:l(`used.${n.type}`)})})),n?.type==="DEFAULT"&&e(Q,{label:l(`flow.${vt.get(m)}`)}),!n?.type&&l("used.notInUse")]})},Vt=["poll","ping"],B=10,G=600,be=0,ye=600,Mt=({realm:i,realmUpdated:n})=>{const{adminClient:l}=E(),{t}=C(),a=L({mode:"onChange"}),{realm:r}=_(),{addAlert:m,addError:c}=D(),p=h=>ne(h,a.setValue);Y(()=>p(i),[]);const g=async h=>{try{await l.realms.update({realm:r},le(h));const f=await l.realms.findOne({realm:r});n(f),p(f),m(t("updateCibaSuccess"),x.success)}catch(f){c("updateCibaError",f)}};return e(M,{variant:"light",children:b(z,{role:"manage-realm",isHorizontal:!0,onSubmit:a.handleSubmit(g),children:[b(U,{...a,children:[e(j,{name:"attributes.cibaBackchannelTokenDeliveryMode",label:t("cibaBackchannelTokenDeliveryMode"),labelIcon:t("cibaBackchannelTokenDeliveryModeHelp"),options:Vt.map(h=>({key:h,value:t(`cibaBackhannelTokenDeliveryModes.${h}`)})),controller:{defaultValue:""}}),e(W,{name:"attributes.cibaExpiresIn",type:"number",min:B,max:G,label:t("cibaExpiresIn"),labelIcon:t("cibaExpiresInHelp"),rules:{min:{value:B,message:t("greaterThan",{value:B})},max:{value:G,message:t("lessThan",{value:G})},required:t("required")}}),e(W,{name:"attributes.cibaInterval",type:"number",min:B,max:G,label:t("cibaInterval"),labelIcon:t("cibaIntervalHelp"),rules:{min:{value:be,message:t("greaterThan",{value:be})},max:{value:ye,message:t("lessThan",{value:ye})},required:t("required")}}),e(j,{name:"attributes.cibaAuthRequestedUserHint",label:t("cibaAuthRequestedUserHint"),labelIcon:t("cibaAuthRequestedUserHintHelp"),options:["login_hint","id_token_hint","login_hint_token"],controller:{defaultValue:""},isDisabled:!0})]}),b(K,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!a.formState.isValid||!a.formState.isDirty,children:t("save")}),e(w,{"data-testid":"reload",variant:O.link,onClick:()=>p({...i}),children:t("reload")})]})]})})},F=["totp","hotp"],fe=["SHA1","SHA256","SHA512"],Ae=[6,8],$t=({realm:i,realmUpdated:n})=>{const{adminClient:l}=E(),{t}=C(),a=L({mode:"onChange",defaultValues:i}),{control:r,reset:m,handleSubmit:c,formState:{isValid:p,isDirty:g}}=a,{realm:h}=_(),{addAlert:f,addError:I}=D(),d=De(),y=Le({name:"otpPolicyType",control:r,defaultValue:F[0]}),v=o=>m(o);Y(()=>v(i),[]);const s=Oe(()=>{const o=(i.otpSupportedApplications??[]).map(u=>t(`otpSupportedApplications.${u}`));return d(o,u=>u)},[i.otpSupportedApplications]);return e(M,{variant:"light",children:e(z,{role:"manage-realm",isHorizontal:!0,onSubmit:c(async o=>{try{await l.realms.update({realm:h},o);const u=await l.realms.findOne({realm:h});n(u),v(u),f(t("updateOtpSuccess"),x.success)}catch(u){I("updateOtpError",u)}}),className:"keycloak__otp_policies_authentication__form",children:b(U,{...a,children:[e(q,{label:t("otpType"),labelIcon:e(V,{helpText:t("otpTypeHelp"),fieldLabelId:"otpType"}),hasNoPaddingTop:!0,children:e(te,{name:"otpPolicyType","data-testid":"otpPolicyType",defaultValue:F[0],control:r,render:({field:o})=>e(R,{children:F.map(u=>e(ce,{id:u,"data-testid":u,isChecked:o.value===u,name:"otpPolicyType",onChange:()=>o.onChange(u),label:t(`policyType.${u}`),className:"keycloak__otp_policies_authentication__policy-type"},u))})})}),e(j,{name:"otpPolicyAlgorithm",label:t("otpHashAlgorithm"),labelIcon:t("otpHashAlgorithmHelp"),options:fe.map(o=>({key:`Hmac${o}`,value:o})),controller:{defaultValue:`Hmac${fe[0]}`}}),e(q,{label:t("otpPolicyDigits"),labelIcon:e(V,{helpText:t("otpPolicyDigitsHelp"),fieldLabelId:"otpPolicyDigits"}),hasNoPaddingTop:!0,children:e(te,{name:"otpPolicyDigits","data-testid":"otpPolicyDigits",defaultValue:Ae[0],control:r,render:({field:o})=>e(R,{children:Ae.map(u=>e(ce,{id:`digit-${u}`,"data-testid":`digit-${u}`,isChecked:o.value===u,name:"otpPolicyDigits",onChange:()=>o.onChange(u),label:u,className:"keycloak__otp_policies_authentication__number-of-digits"},u))})})}),e(de,{name:"otpPolicyLookAheadWindow",label:t("lookAround"),labelIcon:t("lookAroundHelp"),controller:{defaultValue:1,rules:{min:0}}}),y===F[0]&&e(He,{name:"otpPolicyPeriod",label:t("otpPolicyPeriod"),labelIcon:t("otpPolicyPeriodHelp"),units:["second","minute"],controller:{defaultValue:30,rules:{min:1,max:{value:120,message:t("maxLength",{length:"2 "+t("minutes")})}}}}),y===F[1]&&e(de,{name:"otpPolicyInitialCounter",label:t("initialCounter"),labelIcon:t("initialCounterHelp"),controller:{defaultValue:30,rules:{min:1,max:120}}}),e(q,{label:t("supportedApplications"),labelIcon:e(V,{helpText:t("supportedApplicationsHelp"),fieldLabelId:"supportedApplications"}),children:e("span",{"data-testid":"supportedApplications",children:e(Ue,{children:s.map(o=>e(Ke,{isReadOnly:!0,children:o},o))})})}),y===F[0]&&e(_e,{name:"otpPolicyCodeReusable",label:t("otpPolicyCodeReusable"),labelIcon:t("otpPolicyCodeReusableHelp"),labelOn:t("on"),labelOff:t("off")}),b(K,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!p||!g,children:t("save")}),e(w,{"data-testid":"reload",variant:O.link,onClick:()=>m({...i}),children:t("reload")})]})]})})})},Lt=({policy:{id:i,configType:n,defaultValue:l,displayName:t},onRemove:a})=>{const{t:r}=C(),{control:m,register:c,formState:{errors:p}}=Be(),g=p[i];return b(q,{label:t,fieldId:i,isRequired:!0,labelIcon:e(V,{helpText:r(`passwordPoliciesHelp.${i}`),fieldLabelId:i}),children:[b(Ge,{children:[b(ue,{isFilled:!0,children:[n&&n!=="int"&&e(je,{id:i,"data-testid":i,...c(i,{required:!0}),defaultValue:l,validated:g?me.error:me.default}),n==="int"&&e(te,{name:i,defaultValue:Number.parseInt(l||"0"),control:m,render:({field:h})=>{const I=y=>h.onChange(Math.max(y,0)),d=Number(h.value);return e(We,{id:i,value:d,min:0,onPlus:()=>I(d+1),onMinus:()=>I(d-1),onChange:y=>{const v=Number(y.currentTarget.value);I(isNaN(v)?0:v)},className:"keycloak__policies_authentication__number-field"})}}),!n&&e(J,{id:i,label:r("on"),labelOff:r("off"),isChecked:!0,isDisabled:!0,"aria-label":t})]}),e(ue,{children:e(w,{"data-testid":`remove-${i}`,variant:"link",className:"keycloak__policies_authentication__minus-icon",onClick:()=>a(i),"aria-label":r("remove"),children:e(Ye,{})})})]}),g&&e(ze,{message:r("required")})]})},Fe=" and ",Ut=(i,n)=>i.map(l=>`${l.id}(${n[l.id]})`).join(Fe),Kt=(i,n)=>i.split(Fe).map(Bt).reduce((l,{id:t,value:a})=>{const r=n.find(m=>m.id===t);return r?l.concat({...r,value:a}):l},[]);function Bt(i){const n=i.indexOf("(");if(n===-1)return{id:i.trim()};const l=i.substring(0,n).trim(),t=i.lastIndexOf(")");if(t===-1)return{id:l};const a=i.substring(n+1,t).trim();return{id:l,value:a}}const ge=({onSelect:i,selectedPolicies:n})=>{const{t:l}=C(),{passwordPolicies:t}=ke(),[a,r]=T(!1),m=Oe(()=>t?.filter(c=>n.find(p=>p.id===c.id)===void 0),[n]);return e(ot,{onSelect:(c,p)=>{i(p),r(!1)},toggle:c=>e(st,{ref:c,onClick:()=>r(!a),isExpanded:a,isDisabled:m?.length===0,style:{width:"300px"},"data-testid":"add-policy",children:l("addPolicy")}),isOpen:a,children:e(rt,{children:m?.map(c=>e(ct,{value:c,children:c.displayName},c.id))})})},Gt=({realm:i,realmUpdated:n})=>{const{adminClient:l}=E(),{t}=C(),{passwordPolicies:a}=ke(),{addAlert:r,addError:m}=D(),{realm:c}=_(),[p,g]=T([]),h=o=>{g([...p,o]),d(o.id,o.defaultValue,{shouldDirty:!0})},f=L({defaultValues:{}}),{handleSubmit:I,setValue:d,reset:y,formState:{isDirty:v}}=f,s=o=>{y();const u=Kt(o.passwordPolicy||"",a);u.forEach(S=>{d(S.id,S.value)}),g(u)};Y(()=>s(i),[]);const A=async o=>{const u={...i,passwordPolicy:Ut(p,o)};try{await l.realms.update({realm:c},u),n(u),s(u),r(t("updatePasswordPolicySuccess"),x.success)}catch(S){m("updatePasswordPolicyError",S)}};return b(M,{variant:"light",className:"pf-v5-u-p-0",children:[(p.length!==0||i.passwordPolicy)&&b(R,{children:[e(Xe,{children:e(Qe,{children:e(Ne,{children:e(ge,{onSelect:h,selectedPolicies:p})})})}),e(Je,{}),e(M,{variant:"light",children:e(U,{...f,children:b(z,{className:"keycloak__policies_authentication__form",role:"manage-realm",isHorizontal:!0,onSubmit:I(A),children:[p.map((o,u)=>e(Lt,{policy:o,onRemove:S=>{g(p.filter(H=>H.id!==S)),d(o.id,"",{shouldDirty:!0})}},`${o.id}-${u}`)),b(K,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!v,children:t("save")}),e(w,{"data-testid":"reload",variant:O.link,onClick:()=>s(i),children:t("reload")})]})]})})})]}),!p.length&&!i.passwordPolicy&&b(Ze,{"data-testid":"empty-state",variant:"lg",children:[e(et,{titleText:e(R,{children:t("noPasswordPolicies")}),icon:e(tt,{icon:at}),headingLevel:"h1"}),e(it,{children:t("noPasswordPoliciesInstructions")}),e(nt,{children:e(lt,{children:e(ge,{onSelect:h,selectedPolicies:[]})})})]})]})},jt=["ES256","ES384","ES512","RS256","RS384","RS512","Ed25519","RS1"],Wt=["not specified","none","indirect","direct"],Yt=["not specified","platform","cross-platform"],zt=["not specified","Yes","No"],Xt=["not specified","required","preferred","discouraged"],$=({name:i,label:n,labelIcon:l,options:t,labelPrefix:a,isMultiSelect:r=!1})=>{const{t:m}=C();return e(j,{name:i,label:n,labelIcon:l,variant:r?"typeaheadMulti":"single",controller:{defaultValue:t[0]},options:t.map(c=>({key:c,value:a?m(`${a}.${c}`):c}))})},Pe=({realm:i,realmUpdated:n,isPasswordLess:l=!1})=>{const{adminClient:t}=E(),{t:a}=C(),{addAlert:r,addError:m}=D(),{realm:c}=_(),{enabled:p}=dt(),g=L({mode:"onChange"}),{setValue:h,handleSubmit:f,formState:{isDirty:I}}=g,d=l?"webAuthnPolicyPasswordless":"webAuthnPolicy",y=s=>ne(s,h);Y(()=>y(i),[]);const v=async s=>{const A=le(s);try{await t.realms.update({realm:c},A),n(A),y(A),r(a("webAuthnUpdateSuccess"),x.success)}catch(o){m("webAuthnUpdateError",o)}};return b(M,{variant:"light",children:[p&&e(Te,{bodyContent:a(`${d}FormHelp`),children:e(Re,{className:"keycloak__section_intro__help",children:b(ee,{children:[e(_t,{})," ",a("webauthnIntro")]})})}),b(z,{role:"manage-realm",isHorizontal:!0,onSubmit:f(v),className:"keycloak__webauthn_policies_authentication__form",children:[b(U,{...g,children:[e(W,{name:`${d}RpEntityName`,label:a("webAuthnPolicyRpEntityName"),labelIcon:a("webAuthnPolicyRpEntityNameHelp"),rules:{required:a("required")}}),e($,{name:`${d}SignatureAlgorithms`,label:a("webAuthnPolicySignatureAlgorithms"),labelIcon:a("webAuthnPolicySignatureAlgorithmsHelp"),options:jt,isMultiSelect:!0}),e(W,{name:`${d}RpId`,label:a("webAuthnPolicyRpId"),labelIcon:a("webAuthnPolicyRpIdHelp")}),e($,{name:`${d}AttestationConveyancePreference`,label:a("webAuthnPolicyAttestationConveyancePreference"),labelIcon:a("webAuthnPolicyAttestationConveyancePreferenceHelp"),options:Wt,labelPrefix:"attestationPreference"}),e($,{name:`${d}AuthenticatorAttachment`,label:a("webAuthnPolicyAuthenticatorAttachment"),labelIcon:a("webAuthnPolicyAuthenticatorAttachmentHelp"),options:Yt,labelPrefix:"authenticatorAttachment"}),e($,{name:`${d}RequireResidentKey`,label:a("webAuthnPolicyRequireResidentKey"),labelIcon:a("webAuthnPolicyRequireResidentKeyHelp"),options:zt,labelPrefix:"residentKey"}),e($,{name:`${d}UserVerificationRequirement`,label:a("webAuthnPolicyUserVerificationRequirement"),labelIcon:a("webAuthnPolicyUserVerificationRequirementHelp"),options:Xt,labelPrefix:"userVerify"}),e(He,{name:`${d}CreateTimeout`,label:a("webAuthnPolicyCreateTimeout"),labelIcon:a("webAuthnPolicyCreateTimeoutHelp"),units:["second","minute","hour"],controller:{defaultValue:0,rules:{min:0,max:{value:31536,message:a("webAuthnPolicyCreateTimeoutHint")}}}}),e(_e,{name:`${d}AvoidSameAuthenticatorRegister`,label:a("webAuthnPolicyAvoidSameAuthenticatorRegister"),labelIcon:a("webAuthnPolicyAvoidSameAuthenticatorRegisterHelp"),labelOn:a("on"),labelOff:a("off")}),e(q,{label:a("webAuthnPolicyAcceptableAaguids"),fieldId:"webAuthnPolicyAcceptableAaguids",labelIcon:e(V,{helpText:a("webAuthnPolicyAcceptableAaguidsHelp"),fieldLabelId:"webAuthnPolicyAcceptableAaguids"}),children:e(he,{name:`${d}AcceptableAaguids`,"aria-label":a("webAuthnPolicyAcceptableAaguids"),addButtonLabel:"addAaguids"})}),e(q,{label:a("webAuthnPolicyExtraOrigins"),fieldId:"webAuthnPolicyExtraOrigins",labelIcon:e(V,{helpText:a("webAuthnPolicyExtraOriginsHelp"),fieldLabelId:"webAuthnPolicyExtraOrigins"}),children:e(he,{name:`${d}ExtraOrigins`,"aria-label":a("webAuthnPolicyExtraOrigins"),addButtonLabel:"addOrigins"})})]}),b(K,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!I,children:a("save")}),e(w,{"data-testid":"reload",variant:O.link,onClick:()=>y(i),children:a("reload")})]})]})]})},Qt=()=>{const{adminClient:i}=E(),{t:n}=C(),[l,t]=T(1),{realm:a}=_(),[r,m]=T();return ie(async()=>{const c=await i.realms.findOne({realm:a});if(!c)throw new Error(n("notFound"));return c},c=>{m(c)},[]),r?b(kt,{activeKey:l,onSelect:(c,p)=>t(p),mountOnEnter:!0,unmountOnExit:!0,children:[e(k,{id:"passwordPolicy",eventKey:1,title:e(N,{children:n("passwordPolicy")}),children:e(Gt,{realm:r,realmUpdated:m})}),e(k,{id:"otpPolicy",eventKey:2,title:e(N,{children:n("otpPolicy")}),children:e($t,{realm:r,realmUpdated:m})}),e(k,{id:"webauthnPolicy",eventKey:3,title:e(N,{children:n("webauthnPolicy")}),children:e(Pe,{realm:r,realmUpdated:m})}),e(k,{id:"webauthnPasswordlessPolicy",eventKey:4,title:e(N,{children:n("webauthnPasswordlessPolicy")}),children:e(Pe,{realm:r,realmUpdated:m,isPasswordLess:!0})}),e(k,{"data-testid":"tab-ciba-policy",eventKey:5,title:e(N,{children:n("cibaPolicy")}),children:e(Mt,{realm:r,realmUpdated:m})})]}):e(oe,{})},Jt=({id:i,alias:n,usedBy:l,builtIn:t})=>{const{t:a}=C(),{realm:r}=_();return b(R,{children:[e(xe,{to:ht({realm:r,id:i,usedBy:l?.type||"notInUse",builtIn:t?"builtIn":void 0}),children:n},`link-${i}`)," ",t&&e(bt,{children:a("buildIn")},`label-${i}`)]})};function Da(){const{adminClient:i}=E(),{t:n}=C(),{realm:l,realmRepresentation:t}=_(),[a,r]=T(0),m=()=>r(a+1),{addAlert:c,addError:p}=D(),g=De(),[h,f]=T(),[I,d]=Z(),[y,v]=Z(),s=async()=>{const se=await(await Ie(`${Se(i.baseUrl)}admin/realms/${l}/ui-ext/authentication-management/flows`,{method:"GET",headers:Ce(await i.getAccessToken())})).json();return se?xt(g(se,Pt("alias")),qe=>qe.usedBy?.type):[]},A=P=>At(pe({realm:l,tab:P})),o=A("flows"),u=A("required-actions"),S=A("policies"),[H,X]=yt({titleKey:"deleteConfirmFlow",children:b(Nt,{i18nKey:"deleteConfirmFlowMessage",children:[" ",e("strong",{children:{flow:h?h.alias:""}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:O.danger,onConfirm:async()=>{try{await i.authenticationManagement.deleteFlow({flowId:h.id}),m(),c(n("deleteFlowSuccess"),x.success)}catch(P){p("deleteFlowError",P)}}});return t?b(R,{children:[e(X,{}),I&&e(It,{name:h?h.alias:"",description:h?.description,toggleDialog:d,onComplete:()=>{m(),d()}}),y&&e(Ct,{onClose:()=>{v(),m()},flowAlias:h?.alias}),e(gt,{titleKey:"titleAuthentication",subKey:"authenticationExplain",helpUrl:ut.authenticationUrl,divider:!1}),e(M,{variant:"light",className:"pf-v5-u-p-0",children:b(ft,{isBox:!0,defaultLocation:pe({realm:l,tab:"flows"}),children:[e(k,{"data-testid":"flows",title:e(N,{children:n("flows")}),...o,children:e(Ee,{loader:s,ariaLabelKey:"titleAuthentication",searchPlaceholderKey:"searchForFlow",toolbarItem:e(Ne,{children:e(w,{component:P=>e(xe,{...P,to:mt({realm:l})}),children:n("createFlow")})}),actionResolver:({data:P})=>[{title:n("duplicate"),onClick:()=>{d(),f(P)}},...P.usedBy?.type!=="DEFAULT"?[{title:n("bindFlow"),onClick:()=>{v(),f(P)}}]:[],...!P.builtIn&&!P.usedBy?[{title:n("delete"),onClick:()=>{f(P),H()}}]:[]],columns:[{name:"alias",displayKey:"flowName",cellRenderer:P=>e(Jt,{...P})},{name:"usedBy",displayKey:"usedBy",cellRenderer:P=>e(qt,{authType:P})},{name:"description",displayKey:"description"}],emptyState:e(pt,{message:n("emptyEvents"),instructions:n("emptyEventsInstructions")})},a)}),e(k,{"data-testid":"requiredActions",title:e(N,{children:n("requiredActions")}),...u,children:e(Dt,{})}),e(k,{"data-testid":"policies",title:e(N,{children:n("policies")}),...S,children:e(Qt,{})})]})})]}):e(oe,{})}export{Da as default};
//# sourceMappingURL=AuthenticationSection-Dx7x8xSl.js.map
