import{jsxs as l,jsx as e}from"react/jsx-runtime";import{a as I,Y as A,n as U,N as v,_ as b,O as P,S as C,J as f,u as _,b as x,l as E,V as H,d as O,e as j,j as D,P as L,A as G,f as k,L as q,f6 as F,p as z,q as R,o as B}from"./main-hjbDDO6j.js";import{D as J}from"./DynamicComponents-2Oogxguf.js";import{F as W}from"./FormAccess-DEsYjDHG.js";import{u as Y}from"./useParams-XtwJXIDJ.js";import{E as K}from"./ExtendedHeader-YYzKCuX6.js";import{S as M}from"./SettingsCache-B8YydRw1.js";import"react";import"react-dom";import"./ClientSelect-Di5Ep3wz.js";import"./FileUpload-DFzHUp8z.js";import"./CodeEditor-BF8OqNGf.js";import"./copy-icon-ePLWnxgr.js";import"./GroupPickerDialog-CJH5Fdnt.js";import"./DataListItemRow-C-0mzg8R.js";import"./KeySelect-CBdQO7FV.js";import"./MultiLineInput-BKovUfcB.js";import"./AddRoleMappingModal-B-7S42YC.js";import"./translationFormatter-aKDacg4X.js";import"./useLocaleSort-Bon3wgU4.js";import"./ConfirmDialog-DN_NVsrg.js";import"./filter-icon-I49U7vdU.js";import"./ViewHeader-Dr6ZoEJz.js";import"./isEqual-DwRuOUtl.js";const Q=()=>{const{t:r}=I(),a=A(),{control:o,watch:t}=a,d=t("config.fullSyncPeriod","-1"),c=t("config.changedSyncPeriod","-1");return l(U,{...a,children:[e(v,{label:r("periodicFullSync"),labelIcon:e(b,{helpText:r("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(C,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:(m,s)=>{i.onChange(s?"604800":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicFullSync")})})}),d!=="-1"&&e(f,{name:"config.fullSyncPeriod",label:r("fullSyncPeriod"),labelIcon:r("fullSyncPeriodHelp"),type:"number",min:-1,defaultValue:"604800"}),e(v,{label:r("periodicChangedUsersSync"),labelIcon:e(b,{helpText:r("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(C,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:(m,s)=>{i.onChange(s?"86400":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicChangedUsersSync")})})}),c!=="-1"&&e(f,{name:"config.changedSyncPeriod",label:r("changedUsersSyncPeriod"),labelIcon:r("changedUsersSyncHelp"),type:"number",min:-1,defaultValue:"86400"})]})};function Pe(){const{adminClient:r}=_(),{t:a}=I(),{id:o,providerId:t}=Y(),d=x(),c=E({mode:"onChange"}),{reset:i,setValue:m,handleSubmit:s,formState:{isDirty:V}}=c,{addAlert:w,addError:N}=H(),{realm:y,realmRepresentation:T}=O(),g=(j().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(n=>n.id===t);D(async()=>{if(o)return await r.components.findOne({id:o})},n=>{if(n)B(n,m);else if(o)throw new Error(a("notFound"))},[]);const h=async n=>{const S=z({...n,config:Object.fromEntries(Object.entries(n.config||{}).map(([p,u])=>[p,Array.isArray(u)?u:[u]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:T?.id});try{o?await r.components.update({id:o},S):(await r.components.create(S),d(F({realm:y}))),i({...n}),w(a(o?"userProviderSaveSuccess":"createUserProviderSuccess"),R.success)}catch(p){N(o?"userProviderSaveError":"createUserProviderError",p)}};return l(U,{...c,children:[e(K,{provider:t,save:()=>s(h)()}),e(L,{variant:"light",children:l(W,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:s(h),children:[e(f,{name:"name",label:a("uiDisplayName"),labelIcon:a("uiDisplayNameHelp"),rules:{required:a("validateName")}}),e(J,{properties:g?.properties||[]}),g?.metadata.synchronizable&&e(Q,{}),e(M,{form:c,unWrap:!0}),l(G,{children:[e(k,{isDisabled:!V,variant:"primary",type:"submit","data-testid":"custom-save",children:a("save")}),e(k,{variant:"link",component:n=>e(q,{...n,to:F({realm:y})}),"data-testid":"custom-cancel",children:a("cancel")})]})]})})]})}export{Pe as default};
//# sourceMappingURL=CustomProviderSettings-D-iBINTj.js.map
