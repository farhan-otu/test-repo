import{jsxs as n,Fragment as C,jsx as a}from"react/jsx-runtime";import{u as b,a as F,b as y,d as w,l as S,V as x,P as A,n as T,J as V,A as j,aq as E,f as I,L as P,bM as k,o as L,s as N,v as O,x as H,p as J,q as U,bN as $}from"./main-hjbDDO6j.js";import{useState as q}from"react";import{F as z}from"./FormAccess-DEsYjDHG.js";import{F as D}from"./FileUploadForm-CQxs07NG.js";import{V as G}from"./ViewHeader-Dr6ZoEJz.js";import{C as K,a as W}from"./ClientDescription-Dn5Zssht.js";import{L as B}from"./CodeEditor-BF8OqNGf.js";import"react-dom";import"./copy-icon-ePLWnxgr.js";import"./FileUpload-DFzHUp8z.js";import"./SwitchControl-C_wbgFy3.js";const M=r=>r.match(/(<.[^(><.)]+>)/g);function ie(){const{adminClient:r}=b(),{t:s}=F(),c=y(),{realm:o}=w(),i=S(),{handleSubmit:m,setValue:d,formState:p}=i,[u,h]=q({}),{addAlert:f,addError:l}=x(),g=async t=>{try{const e=await v(t);L(e,d),h(e)}catch(e){l("importParseError",e)}};async function v(t){if(!M(t))return JSON.parse(t);const e=await N(`${H(r.baseUrl)}admin/realms/${o}/client-description-converter`,{method:"POST",body:t,headers:O(await r.getAccessToken())});if(!e.ok)throw new Error(`Server responded with invalid status: ${e.statusText}`);return e.json()}return n(C,{children:[a(G,{titleKey:"importClient",subKey:"clientsExplain"}),a(A,{variant:"light",children:a(z,{isHorizontal:!0,onSubmit:m(async t=>{try{const e=await r.clients.create({...u,...J({...t,attributes:t.attributes||{}})});f(s("clientImportSuccess"),U.success),c($({realm:o,clientId:e.id,tab:"settings"}))}catch(e){l("clientImportError",e)}}),role:"manage-clients",children:n(T,{...i,children:[a(D,{id:"realm-file",language:B.json,extension:".json,.xml",helpText:s("helpFileUploadClient"),onChange:g}),a(K,{hasConfigureAccess:!0}),a(V,{name:"protocol",label:s("type"),readOnly:!0}),a(W,{unWrap:!0}),n(j,{children:[a(E,{formState:p,allowInvalid:!0,allowNonDirty:!0,children:s("save")}),a(I,{variant:"link",component:t=>a(P,{...t,to:k({realm:o})}),children:s("cancel")})]})]})})})]})}export{ie as default};
//# sourceMappingURL=ImportForm-2DOXmgOB.js.map
