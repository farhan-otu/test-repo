import{jsxs as d,Fragment as v,jsx as e}from"react/jsx-runtime";import{u as g,a as h,Y as F,ay as P,N as S,_ as b,a5 as k,b as D,dw as E,l as O,V as A,d as V,P as w,n as x,A as L,f,L as U,dJ as J,q as K,dK as N}from"./main-hjbDDO6j.js";import{F as T}from"./FormAccess-DEsYjDHG.js";import{V as _}from"./ViewHeader-Dr6ZoEJz.js";import{D as j,O as G,a as H}from"./OIDCGeneralSettings-H3mSqwkG.js";import{J as z}from"./JsonFileUpload-D9OTErpO.js";import{D as B}from"./DiscoveryEndpointField-kj_XgotV.js";import"react";import"react-dom";import"./copy-icon-ePLWnxgr.js";import"./SwitchControl-C_wbgFy3.js";/* empty css                           */import"./ExpandableSection-CqcMlejr.js";import"./ClientIdSecret-CHx560HZ.js";import"./RedirectUrl-CrIeTDhq.js";import"./FileUploadForm-CQxs07NG.js";import"./FileUpload-DFzHUp8z.js";import"./CodeEditor-BF8OqNGf.js";const $=()=>{const{adminClient:l}=g(),{t}=h(),m="oidc",{setValue:p,setError:c,clearErrors:n,formState:{errors:o}}=F(),u=r=>{Object.keys(r).map(i=>p(`config.${i}`,r[i]))},y=async r=>{if(n("discoveryError"),!r)return;const i=new FormData;i.append("providerId",m),i.append("file",new Blob([JSON.stringify(r)]));try{const a=await l.identityProviders.importFromUrl(i);u(a)}catch(a){c("discoveryError",{type:"manual",message:a.message})}};return d(v,{children:[e(P,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("oidcSettings")}),e(B,{id:"oidc",fileUpload:d(S,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(b,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),children:[e(z,{id:"kc-import-config",helpText:t("identity=providers-help:jsonFileUpload"),hideDefaultPreview:!0,unWrap:!0,validated:o.discoveryError?"error":"default",onChange:r=>y(r)}),o.discoveryError&&e(k,{message:o.discoveryError.message})]}),children:r=>e(j,{readOnly:r})})]})};function le(){const{adminClient:l}=g(),{t}=h(),m=D(),{pathname:p}=E(),c=p.includes("keycloak-oidc"),n=`${c?"keycloak-":""}oidc`,o=O({defaultValues:{alias:n},mode:"onChange"}),{handleSubmit:u,formState:{isDirty:y}}=o,{addAlert:r,addError:i}=A(),{realm:a}=V(),I=async s=>{delete s.discoveryEndpoint;try{await l.identityProviders.create({...s,providerId:n}),r(t("createIdentityProviderSuccess"),K.success),m(N({realm:a,providerId:n,alias:s.alias,tab:"settings"}))}catch(C){i("createIdentityProviderError",C)}};return d(v,{children:[e(_,{titleKey:t(c?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(w,{variant:"light",children:e(x,{...o,children:d(T,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(I),children:[e(G,{}),e($,{}),e(H,{}),d(L,{children:[e(f,{isDisabled:!y,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(f,{variant:"link","data-testid":"cancel",component:s=>e(U,{...s,to:J({realm:a})}),children:t("cancel")})]})]})})})]})}export{le as default};
//# sourceMappingURL=AddOpenIdConnect-CK4ZHrgH.js.map
