import{jsxs as c,Fragment as I,jsx as t}from"react/jsx-runtime";import{u as w,a as z,b as N,V as F,z as V,l as k,j as C,cE as l,D as H,P as U,n as E,J as d,A as P,f as m,B as j,L as q,q as x}from"./main-hjbDDO6j.js";import{useState as B}from"react";import{F as T}from"./FormAccess-DEsYjDHG.js";import{V as G}from"./ViewHeader-Dr6ZoEJz.js";import{u as L}from"./useParams-XtwJXIDJ.js";import{D as J}from"./DeleteScopeDialog-1lT-fTLp.js";import"react-dom";import"./copy-icon-ePLWnxgr.js";import"./ConfirmDialog-DN_NVsrg.js";function $(){const{adminClient:n}=w(),{t:e}=z(),{id:o,scopeId:i,realm:s}=L(),p=N(),{addAlert:S,addError:b}=F(),[v,u]=V(),[r,h]=B(),g=k({mode:"onChange"}),{reset:f,handleSubmit:y}=g;C(async()=>{if(i){const a=await n.clients.getAuthorizationScope({id:o,scopeId:i});if(!a)throw new Error(e("notFound"));return a}},a=>{h(a),f({...a})},[]);const A=async a=>{try{i?(await n.clients.updateAuthorizationScope({id:o,scopeId:i},a),h(a)):(await n.clients.createAuthorizationScope({id:o},{name:a.name,displayName:a.displayName,iconUri:a.iconUri}),p(l({realm:s,clientId:o,tab:"scopes"}))),S(e((i?"update":"create")+"ScopeSuccess"),x.success)}catch(D){b("scopeSaveError",D)}};return c(I,{children:[t(J,{clientId:o,open:v,toggleDialog:u,selectedScope:r,refresh:()=>p(l({realm:s,clientId:o,tab:"scopes"}))}),t(G,{titleKey:i?r?.name:e("createAuthorizationScope"),dropdownItems:i?[t(H,{"data-testid":"delete-resource",onClick:()=>u(),children:e("delete")},"delete")]:void 0}),t(U,{variant:"light",children:t(E,{...g,children:c(T,{isHorizontal:!0,role:"manage-authorization",onSubmit:y(A),children:[t(d,{name:"name",label:e("name"),labelIcon:e("scopeNameHelp"),rules:{required:e("required")}}),t(d,{name:"displayName",label:e("displayName"),labelIcon:e("scopeDisplayNameHelp")}),t(d,{name:"iconUri",label:e("iconUri"),labelIcon:e("iconUriHelp")}),t(P,{children:c("div",{className:"pf-v5-u-mt-md",children:[t(m,{variant:j.primary,type:"submit","data-testid":"save",children:e("save")}),r?t(m,{variant:"link","data-testid":"revert",onClick:()=>f({...r}),children:e("revert")}):t(m,{variant:"link","data-testid":"cancel",component:a=>t(q,{...a,to:l({realm:s,clientId:o,tab:"scopes"})}),children:e("cancel")})]})})]})})})]})}export{$ as default};
//# sourceMappingURL=ScopeDetails-AknqJyKh.js.map
