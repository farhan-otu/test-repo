import{jsxs as y,jsx as e,Fragment as O}from"react/jsx-runtime";import{u as T,a as N,V as L,d as k,l as x,M as E,m as I,f as v,B as V,G as q,F as U,N as M,a1 as P,q as d,D as F,al as j,P as G,z as K,c7 as z,aj as A,dC as H}from"./main-hjbDDO6j.js";import{useState as S}from"react";import{u as $}from"./ConfirmDialog-DN_NVsrg.js";import{V as J}from"./ViewHeader-Dr6ZoEJz.js";import{S as Q}from"./SessionsTable-BFpY614L.js";import{F as W}from"./filter-icon-I49U7vdU.js";import"react-dom";import"./useFormatDate-DtCZfuLt.js";const X=({handleModalToggle:n,save:l})=>{const{adminClient:a}=T(),{t}=N(),{addAlert:s,addError:c}=L(),{realm:r,realmRepresentation:u,refresh:g}=k(),{register:m,handleSubmit:C}=x(),b=(o,p)=>{const i=o.successRequests?.length||0,h=o.failedRequests?.length||0;i===0&&h===0?s(t("noAdminUrlSet"),d.warning):h>0?(s(t(""+p+"Success",{successNodes:o.successRequests}),d.success),s(t(""+p+"Fail",{failedNodes:o.failedRequests}),d.danger)):s(t(""+p+"Success",{successNodes:o.successRequests}),d.success)},w=async()=>{try{await a.realms.update({realm:r},{realm:r,notBefore:Date.now()/1e3}),s(t("notBeforeSuccess"),d.success)}catch(o){c("setToNowError",o)}},f=async()=>{try{await a.realms.update({realm:r},{realm:r,notBefore:0}),s(t("notBeforeClearedSuccess"),d.success),g()}catch(o){c("notBeforeError",o)}},B=async()=>{const o=await a.realms.pushRevocation({realm:r});b(o,"notBeforePush"),g()};return y(E,{variant:I.small,title:t("revocation"),isOpen:!0,onClose:n,actions:[e(v,{"data-testid":"set-to-now-button",variant:"tertiary",onClick:()=>{w(),n()},form:"revocation-modal-form",children:t("setToNow")},"set-to-now"),e(v,{"data-testid":"clear-not-before-button",variant:"tertiary",onClick:()=>{f(),n()},form:"revocation-modal-form",children:t("clear")},"clear"),e(v,{"data-testid":"modal-test-connection-button",variant:"secondary",onClick:()=>{B(),n()},form:"revocation-modal-form",children:t("push")},"push"),e(v,{id:"modal-cancel","data-testid":"cancel",variant:V.link,onClick:()=>{n()},children:t("cancel")},"cancel")],children:[e(q,{className:"kc-revocation-description-text",children:t("revocationDescription")}),e(U,{id:"revocation-modal-form",isHorizontal:!0,onSubmit:C(l),children:e(M,{className:"kc-revocation-modal-form-group",label:t("notBefore"),name:"notBefore",fieldId:"not-before",children:e(P,{"data-testid":"not-before-input",autoFocus:!0,readOnly:!0,value:u?.notBefore===0?t("none"):new Date(u?.notBefore*1e3).toString(),type:"text",id:"not-before",...m("notBefore")})})})]})},Y=({filterType:n,onChange:l})=>{const{t:a}=N(),[t,s]=K();return y(z,{"data-testid":"filter-session-type-select",isOpen:t,onToggle:s,toggleIcon:e(W,{}),onSelect:c=>{l(c),s()},selections:n,children:[e(A,{"data-testid":"all-sessions-option",value:"ALL",children:a("sessionsType.allSessions")}),e(A,{"data-testid":"regular-sso-option",value:"REGULAR",children:a("sessionsType.regularSSO")}),e(A,{"data-testid":"offline-option",value:"OFFLINE",children:a("sessionsType.offline")})]})};function ie(){const{adminClient:n}=T(),{t:l}=N(),[a,t]=S(0),s=()=>t(a+1),{addError:c}=L(),{realm:r}=k(),[u,g]=S(!1),[m,C]=S("ALL"),[b,w]=S(!1),f=()=>{g(!u)},B=async(i,h,D)=>{const R=await H(n,"ui-ext/sessions",{first:`${i}`,max:`${h}`,type:m,search:D||""});return w(R.length===0),R},[o,p]=$({titleKey:"logoutAllSessions",messageKey:"logoutAllDescription",continueButtonLabel:"confirm",onConfirm:async()=>{try{await n.realms.logoutAll({realm:r}),s()}catch(i){c("logoutAllSessionsError",i)}}});return y(O,{children:[e(p,{}),e(J,{dropdownItems:[e(F,{"data-testid":"revocation",component:"button",onClick:()=>f(),children:l("revocation")},"toggle-modal"),e(F,{"data-testid":"logout-all",component:"button",isDisabled:b,onClick:o,children:l("signOutAllActiveSessions")},"delete-role")],titleKey:"titleSessions",subKey:"sessionExplain",helpUrl:j.sessionsUrl}),y(G,{variant:"light",className:"pf-v5-u-p-0",children:[u&&e(X,{handleModalToggle:f,save:()=>{f()}}),e(Q,{loader:B,isSearching:m!=="ALL",isPaginated:!0,filter:e(Y,{filterType:m,onChange:i=>{C(i),s()}})},a)]})]})}export{ie as default};
//# sourceMappingURL=SessionsSection-CF9qiELJ.js.map
