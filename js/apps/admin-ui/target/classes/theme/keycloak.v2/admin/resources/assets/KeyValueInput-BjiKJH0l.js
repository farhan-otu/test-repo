import{jsx as e,jsxs as n,Fragment as x}from"react/jsx-runtime";import{useState as N,useMemo as q,Fragment as F}from"react";import{a as S,bX as T,c7 as P,aj as j,a1 as m,Y as w,c0 as G,K as O,cx as B,cy as d,d2 as $,d3 as g,f as v,a4 as H,ac as I,a9 as K,ad as L,ae as M}from"./main-hjbDDO6j.js";import{K as R,A as z,a as U}from"./KeySelect-CBdQO7FV.js";const V=({selectItems:t,keyValue:c,...l})=>{const{t:s}=S(),{field:r}=T(l),[u,i]=N(!1),p=q(()=>t.find(a=>a.key===c),[t,c]);return p?.values?e(P,{onToggle:a=>i(a),isOpen:u,onSelect:a=>{r.onChange(a),i(!1)},selections:r.value?[r.value]:s("choose"),placeholderText:s("valuePlaceholder"),children:p.values.map(a=>e(j,{value:a,children:a},a))}):e(m,{"aria-label":s("customValue"),"data-testid":l.name,...r})},Q=({name:t,label:c="attributes",defaultKeyValue:l,isDisabled:s=!1})=>{const{t:r}=S(),{control:u,register:i,formState:{errors:p}}=w(),{fields:a,append:A,remove:C}=G({shouldUnregister:!0,control:u,name:t}),f=()=>A({key:"",value:""}),E=O({name:t,control:u,defaultValue:[]});return a.length>0?n(x,{children:[n(B,{hasGutter:!0,children:[e(d,{className:"pf-v5-c-form__label",span:5,children:e("span",{className:"pf-v5-c-form__label-text",children:r("key")})}),e(d,{className:"pf-v5-c-form__label",span:7,children:e("span",{className:"pf-v5-c-form__label-text",children:r("value")})}),a.map((_,o)=>{const h=p[t]?.[o],k=!!h?.key,y=!!h?.value||!!h?.message,b=h?.message||r("valueError");return n(F,{children:[n(d,{span:5,children:[l?e(R,{name:`${t}.${o}.key`,selectItems:l,rules:{required:!0}}):e(m,{placeholder:r("keyPlaceholder"),"aria-label":r("key"),"data-testid":`${t}-key`,...i(`${t}.${o}.key`,{required:!0}),validated:k?"error":"default",isRequired:!0,isDisabled:s}),k&&e($,{children:e(g,{variant:"error",children:r("keyError")})})]}),n(d,{span:5,children:[l?e(V,{name:`${t}.${o}.value`,keyValue:E[o]?.key,selectItems:l,rules:{required:!0}}):e(m,{placeholder:r("valuePlaceholder"),"aria-label":r("value"),"data-testid":`${t}-value`,...i(`${t}.${o}.value`,{required:!0}),validated:y?"error":"default",isRequired:!0,isDisabled:s}),y&&e($,{children:e(g,{variant:"error",children:b})})]}),e(d,{span:2,children:e(v,{variant:"link",title:r("removeAttribute"),onClick:()=>C(o),"data-testid":`${t}-remove`,isDisabled:s,children:e(H,{})})})]},_.id)})]}),e(z,{children:e(U,{children:e(v,{"data-testid":`${t}-add-row`,className:"pf-v5-u-px-0 pf-v5-u-mt-sm",variant:"link",icon:e(I,{}),onClick:f,isDisabled:s,children:r("addAttribute",{label:c})})})})]}):n(K,{"data-testid":`${t}-empty-state`,className:"pf-v5-u-p-0",variant:"xs",children:[e(L,{children:r("missingAttributes",{label:c})}),e(M,{children:e(v,{"data-testid":`${t}-add-row`,variant:"link",icon:e(I,{}),size:"sm",onClick:f,isDisabled:s,children:r("addAttribute",{label:c})})})]})};export{Q as K};
//# sourceMappingURL=KeyValueInput-BjiKJH0l.js.map
